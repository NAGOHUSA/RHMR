import React, { useState, useEffect } from 'react';
import { Home, TrendingUp, Clock, DollarSign, Activity, AlertCircle, BarChart3, MapPin, RefreshCw, Star, ThermometerSun, Zap, Scale } from 'lucide-react';
import { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Area, AreaChart, PieChart, Pie, Cell } from 'recharts';

const RealEstateDashboard = () => {
  const [selectedZip, setSelectedZip] = useState('31088');
  const [lastUpdate, setLastUpdate] = useState(new Date());
  
  // Auto-update timestamp
  useEffect(() => {
    const timer = setInterval(() => {
      setLastUpdate(new Date());
    }, 30000); // Update every 30 seconds
    return () => clearInterval(timer);
  }, []);
  
  // Sample data for charts
  const priceData = [
    { day: 'Mon', price: 285, inventory: 98 },
    { day: 'Tue', price: 287, inventory: 102 },
    { day: 'Wed', price: 288, inventory: 105 },
    { day: 'Thu', price: 289, inventory: 108 },
    { day: 'Fri', price: 290, inventory: 105 },
    { day: 'Sat', price: 289, inventory: 103 },
    { day: 'Sun', price: 290, inventory: 105 }
  ];
  
  const activityData = [
    { name: 'New', value: 12 },
    { name: 'Pending', value: 8 },
    { name: 'Sold', value: 15 },
    { name: 'Reduced', value: 5 }
  ];

  const velocityData = [
    { month: 'Jan', dom: 38, reductions: 22 },
    { month: 'Feb', dom: 35, reductions: 20 },
    { month: 'Mar', dom: 32, reductions: 18 },
    { month: 'Apr', dom: 29, reductions: 16 },
    { month: 'May', dom: 26, reductions: 14 },
    { month: 'Jun', dom: 24, reductions: 15 }
  ];

  const marketComposition = [
    { name: 'Under Contract', value: 35, color: '#4361ee' },
    { name: 'Active', value: 105, color: '#4cc9f0' },
    { name: 'Price Reduced', value: 15, color: '#f8961e' },
    { name: 'New', value: 12, color: '#7209b7' }
  ];

  const inventoryData = [
    { month: 'Jan', count: 135 },
    { month: 'Feb', count: 128 },
    { month: 'Mar', count: 118 },
    { month: 'Apr', count: 112 },
    { month: 'May', count: 108 },
    { month: 'Jun', count: 105 }
  ];

  const formatTime = (date) => {
    return date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-100 via-blue-50 to-slate-100 text-slate-900 p-6">
      {/* Header */}
      <div className="bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 rounded-2xl p-6 mb-6 shadow-2xl border border-slate-700">
        <div className="flex items-center justify-between flex-wrap gap-4">
          <div className="flex items-center gap-4">
            <div className="bg-gradient-to-br from-blue-500 to-cyan-500 p-3 rounded-xl shadow-lg">
              <Home className="w-8 h-8 text-white" />
            </div>
            <div>
              <h1 className="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-400">
                RHMR Pro Dashboard
              </h1>
              <p className="text-slate-400 text-sm">Real-Time Real Estate Intelligence Platform</p>
            </div>
          </div>
          
          <div className="flex gap-3 items-center flex-wrap">
            <select 
              value={selectedZip}
              onChange={(e) => setSelectedZip(e.target.value)}
              className="bg-slate-800/50 border border-slate-600 rounded-xl px-4 py-2.5 text-white backdrop-blur-sm font-medium"
            >
              <option value="31088">üìç 31088 - Warner Robins</option>
              <option value="31093">üìç 31093 - Centerville</option>
              <option value="31098">üìç 31098 - Bonaire</option>
            </select>
            
            <div className="flex items-center gap-2 bg-slate-800/50 px-4 py-2.5 rounded-xl backdrop-blur-sm border border-slate-600">
              <RefreshCw className="w-4 h-4 text-cyan-400 animate-spin" style={{animationDuration: '3s'}} />
              <span className="text-slate-300 text-sm">Updated: {formatTime(lastUpdate)}</span>
            </div>
          </div>
        </div>
        
        {/* Live indicator */}
        <div className="flex items-center gap-4 mt-4">
          <div className="flex items-center gap-2 bg-red-500/20 px-4 py-2 rounded-full border border-red-500/50">
            <div className="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
            <span className="text-red-400 font-semibold text-sm">LIVE</span>
          </div>
          <span className="text-slate-400 text-sm">Auto-updating every 30 seconds</span>
        </div>
      </div>

      {/* Market Pulse Banner */}
      <div className="bg-gradient-to-r from-blue-600 via-purple-600 to-blue-600 rounded-2xl p-8 mb-6 shadow-2xl relative overflow-hidden">
        <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent animate-pulse"></div>
        <div className="relative z-10">
          <div className="flex items-center justify-between mb-6">
            <h2 className="text-3xl font-bold text-white flex items-center gap-3">
              <Activity className="w-8 h-8 text-yellow-300" />
              Market Pulse
            </h2>
            <div className="flex items-center gap-2 bg-white/20 px-4 py-2 rounded-full backdrop-blur-sm">
              <div className="w-2 h-2 bg-red-400 rounded-full animate-pulse"></div>
              <span className="text-white font-semibold">LIVE</span>
            </div>
          </div>
          
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div className="bg-white/10 backdrop-blur-md rounded-xl p-5 border border-white/20 hover:bg-white/15 transition-all">
              <div className="flex items-center gap-2 mb-2">
                <ThermometerSun className="w-5 h-5 text-orange-300" />
                <h4 className="text-white/90 text-sm uppercase tracking-wide">Market Temperature</h4>
              </div>
              <div className="text-4xl font-bold text-white mb-2">82¬∞</div>
              <div className="flex items-center gap-2 text-sm text-white/80">
                <TrendingUp className="w-4 h-4 text-cyan-300" />
                <span>Heating up (+4¬∞ this week)</span>
              </div>
            </div>
            
            <div className="bg-white/10 backdrop-blur-md rounded-xl p-5 border border-white/20 hover:bg-white/15 transition-all">
              <div className="flex items-center gap-2 mb-2">
                <Zap className="w-5 h-5 text-yellow-300" />
                <h4 className="text-white/90 text-sm uppercase tracking-wide">Velocity Score</h4>
              </div>
              <div className="text-4xl font-bold text-white mb-2">87</div>
              <div className="flex items-center gap-2 text-sm text-white/80">
                <Zap className="w-4 h-4 text-yellow-300" />
                <span>Fast-moving market</span>
              </div>
            </div>
            
            <div className="bg-white/10 backdrop-blur-md rounded-xl p-5 border border-white/20 hover:bg-white/15 transition-all">
              <div className="flex items-center gap-2 mb-2">
                <Scale className="w-5 h-5 text-orange-300" />
                <h4 className="text-white/90 text-sm uppercase tracking-wide">Buyer/Seller Index</h4>
              </div>
              <div className="text-4xl font-bold text-white mb-2">68</div>
              <div className="flex items-center gap-2 text-sm text-white/80">
                <Scale className="w-4 h-4 text-orange-300" />
                <span>Seller's market</span>
              </div>
            </div>
            
            <div className="bg-white/10 backdrop-blur-md rounded-xl p-5 border border-white/20 hover:bg-white/15 transition-all">
              <div className="flex items-center gap-2 mb-2">
                <Star className="w-5 h-5 text-yellow-300" />
                <h4 className="text-white/90 text-sm uppercase tracking-wide">Opportunity Score</h4>
              </div>
              <div className="text-4xl font-bold text-white mb-2">92</div>
              <div className="flex items-center gap-2 text-sm text-white/80">
                <Star className="w-4 h-4 text-yellow-300" />
                <span>Excellent for new agents</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      {/* Key Metrics */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
        <div className="bg-white rounded-xl p-6 shadow-lg border-t-4 border-blue-500 hover:shadow-xl transition-all">
          <div className="flex items-center justify-between mb-4">
            <DollarSign className="w-8 h-8 text-blue-500" />
            <span className="text-xs bg-blue-100 text-blue-600 px-3 py-1 rounded-full font-semibold">LIVE</span>
          </div>
          <h3 className="text-slate-500 text-sm mb-2 uppercase tracking-wide font-medium">Median List Price</h3>
          <div className="text-4xl font-bold text-slate-900 mb-3">$289,500</div>
          <div className="flex items-center gap-2 text-green-600 text-sm font-semibold">
            <TrendingUp className="w-4 h-4" />
            <span>+2.1% this month</span>
          </div>
        </div>

        <div className="bg-white rounded-xl p-6 shadow-lg border-t-4 border-purple-500 hover:shadow-xl transition-all">
          <div className="flex items-center justify-between mb-4">
            <DollarSign className="w-8 h-8 text-purple-500" />
            <span className="text-xs bg-purple-100 text-purple-600 px-3 py-1 rounded-full font-semibold">24H</span>
          </div>
          <h3 className="text-slate-500 text-sm mb-2 uppercase tracking-wide font-medium">Median Sale Price</h3>
          <div className="text-4xl font-bold text-slate-900 mb-3">$281,200</div>
          <div className="flex items-center gap-2 text-green-600 text-sm font-semibold">
            <TrendingUp className="w-4 h-4" />
            <span>+1.8% this month</span>
          </div>
          <div className="text-xs text-slate-400 mt-2">24 days avg</div>
        </div>

        <div className="bg-white rounded-xl p-6 shadow-lg border-t-4 border-cyan-500 hover:shadow-xl transition-all">
          <div className="flex items-center justify-between mb-4">
            <Home className="w-8 h-8 text-cyan-500" />
            <span className="text-xs bg-cyan-100 text-cyan-600 px-3 py-1 rounded-full font-semibold">TREND</span>
          </div>
          <h3 className="text-slate-500 text-sm mb-2 uppercase tracking-wide font-medium">Active Inventory</h3>
          <div className="text-4xl font-bold text-slate-900 mb-3">105</div>
          <div className="flex items-center gap-2 text-red-600 text-sm font-semibold">
            <TrendingUp className="w-4 h-4 rotate-180" />
            <span>-8% from last month</span>
          </div>
        </div>

        <div className="bg-white rounded-xl p-6 shadow-lg border-t-4 border-orange-500 hover:shadow-xl transition-all">
          <div className="flex items-center justify-between mb-4">
            <ThermometerSun className="w-8 h-8 text-orange-500" />
            <span className="text-xs bg-orange-100 text-orange-600 px-3 py-1 rounded-full font-semibold">LIVE</span>
          </div>
          <h3 className="text-slate-500 text-sm mb-2 uppercase tracking-wide font-medium">Market Trend</h3>
          <div className="text-4xl font-bold text-slate-900 mb-3">Heating</div>
          <div className="flex items-center gap-2 text-green-600 text-sm font-semibold">
            <TrendingUp className="w-4 h-4" />
            <span>Strong upward momentum</span>
          </div>
        </div>
      </div>

      {/* Charts Section */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
        <div className="bg-white rounded-xl p-6 shadow-lg">
          <h3 className="text-xl font-bold text-slate-900 mb-6 flex items-center gap-2">
            <BarChart3 className="w-6 h-6 text-blue-500" />
            Price Trend Analysis
            <div className="ml-auto flex gap-3 text-sm">
              <div className="flex items-center gap-2">
                <div className="w-3 h-3 rounded-full bg-blue-500"></div>
                <span className="text-slate-600">List Price</span>
              </div>
              <div className="flex items-center gap-2">
                <div className="w-3 h-3 rounded-full bg-purple-500"></div>
                <span className="text-slate-600">Sale Price</span>
              </div>
            </div>
          </h3>
          <ResponsiveContainer width="100%" height={280}>
            <AreaChart data={priceData}>
              <defs>
                <linearGradient id="colorPrice" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="5%" stopColor="#3b82f6" stopOpacity={0.3}/>
                  <stop offset="95%" stopColor="#3b82f6" stopOpacity={0}/>
                </linearGradient>
                <linearGradient id="colorSale" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="5%" stopColor="#a855f7" stopOpacity={0.3}/>
                  <stop offset="95%" stopColor="#a855f7" stopOpacity={0}/>
                </linearGradient>
              </defs>
              <CartesianGrid strokeDasharray="3 3" stroke="#e2e8f0" />
              <XAxis dataKey="day" stroke="#64748b" style={{fontSize: '12px'}} />
              <YAxis stroke="#64748b" style={{fontSize: '12px'}} />
              <Tooltip 
                contentStyle={{ 
                  backgroundColor: '#1e293b', 
                  border: 'none', 
                  borderRadius: '8px',
                  color: '#fff'
                }}
              />
              <Area type="monotone" dataKey="price" stroke="#3b82f6" fill="url(#colorPrice)" strokeWidth={3} />
              <Line type="monotone" dataKey="inventory" stroke="#a855f7" strokeWidth={2} strokeDasharray="5 5" />
            </AreaChart>
          </ResponsiveContainer>
        </div>

        <div className="bg-white rounded-xl p-6 shadow-lg">
          <h3 className="text-xl font-bold text-slate-900 mb-6 flex items-center gap-2">
            <Activity className="w-6 h-6 text-cyan-500" />
            Inventory Levels
          </h3>
          <ResponsiveContainer width="100%" height={280}>
            <BarChart data={inventoryData}>
              <CartesianGrid strokeDasharray="3 3" stroke="#e2e8f0" />
              <XAxis dataKey="month" stroke="#64748b" style={{fontSize: '12px'}} />
              <YAxis stroke="#64748b" style={{fontSize: '12px'}} />
              <Tooltip 
                contentStyle={{ 
                  backgroundColor: '#1e293b', 
                  border: 'none', 
                  borderRadius: '8px',
                  color: '#fff'
                }}
              />
              <Bar dataKey="count" fill="#06b6d4" radius={[8, 8, 0, 0]} />
            </BarChart>
          </ResponsiveContainer>
        </div>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
        <div className="bg-white rounded-xl p-6 shadow-lg">
          <h3 className="text-xl font-bold text-slate-900 mb-6 flex items-center gap-2">
            <Clock className="w-6 h-6 text-orange-500" />
            Market Velocity
            <div className="ml-auto flex gap-3 text-sm">
              <div className="flex items-center gap-2">
                <div className="w-3 h-3 rounded-full bg-orange-500"></div>
                <span className="text-slate-600">Days on Market</span>
              </div>
              <div className="flex items-center gap-2">
                <div className="w-3 h-3 rounded-full bg-pink-500"></div>
                <span className="text-slate-600">Price Reductions</span>
              </div>
            </div>
          </h3>
          <ResponsiveContainer width="100%" height={280}>
            <LineChart data={velocityData}>
              <CartesianGrid strokeDasharray="3 3" stroke="#e2e8f0" />
              <XAxis dataKey="month" stroke="#64748b" style={{fontSize: '12px'}} />
              <YAxis stroke="#64748b" style={{fontSize: '12px'}} />
              <Tooltip 
                contentStyle={{ 
                  backgroundColor: '#1e293b', 
                  border: 'none', 
                  borderRadius: '8px',
                  color: '#fff'
                }}
              />
              <Line type="monotone" dataKey="dom" stroke="#f97316" strokeWidth={3} />
              <Line type="monotone" dataKey="reductions" stroke="#ec4899" strokeWidth={3} strokeDasharray="5 5" />
            </LineChart>
          </ResponsiveContainer>
        </div>

        <div className="bg-white rounded-xl p-6 shadow-lg">
          <h3 className="text-xl font-bold text-slate-900 mb-6 flex items-center gap-2">
            <BarChart3 className="w-6 h-6 text-purple-500" />
            Market Composition
          </h3>
          <ResponsiveContainer width="100%" height={280}>
            <PieChart>
              <Pie
                data={marketComposition}
                cx="50%"
                cy="50%"
                innerRadius={60}
                outerRadius={100}
                paddingAngle={5}
                dataKey="value"
              >
                {marketComposition.map((entry, index) => (
                  <Cell key={`cell-${index}`} fill={entry.color} />
                ))}
              </Pie>
              <Tooltip 
                contentStyle={{ 
                  backgroundColor: '#1e293b', 
                  border: 'none', 
                  borderRadius: '8px',
                  color: '#fff'
                }}
              />
            </PieChart>
          </ResponsiveContainer>
          <div className="grid grid-cols-2 gap-3 mt-4">
            {marketComposition.map((item, i) => (
              <div key={i} className="flex items-center gap-2">
                <div className="w-3 h-3 rounded-full" style={{backgroundColor: item.color}}></div>
                <span className="text-sm text-slate-600">{item.name}: {item.value}</span>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* Realtor Action Items */}
      <div className="bg-white rounded-xl p-6 shadow-lg mb-6">
        <h3 className="text-xl font-bold text-slate-900 mb-6 flex items-center gap-2">
          <AlertCircle className="w-6 h-6 text-orange-500" />
          Realtor Action Items
          <div className="ml-auto flex gap-3 text-sm">
            <div className="flex items-center gap-2">
              <div className="w-3 h-3 rounded-full bg-cyan-500"></div>
              <span className="text-slate-600">High Priority</span>
            </div>
            <div className="flex items-center gap-2">
              <div className="w-3 h-3 rounded-full bg-orange-500"></div>
              <span className="text-slate-600">Medium Priority</span>
            </div>
          </div>
        </h3>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div className="bg-gradient-to-br from-cyan-50 to-cyan-100 p-5 rounded-xl border-l-4 border-cyan-500">
            <h4 className="text-cyan-700 font-bold mb-2 flex items-center gap-2">
              <TrendingUp className="w-5 h-5" />
              Price New Listings Aggressively
            </h4>
            <p className="text-sm text-slate-700">Current market supports 2-3% above recent comps</p>
          </div>
          <div className="bg-gradient-to-br from-orange-50 to-orange-100 p-5 rounded-xl border-l-4 border-orange-500">
            <h4 className="text-orange-700 font-bold mb-2 flex items-center gap-2">
              <AlertCircle className="w-5 h-5" />
              Target Price-Reduced Properties
            </h4>
            <p className="text-sm text-slate-700">15 properties reduced price this week - great opportunities</p>
          </div>
          <div className="bg-gradient-to-br from-cyan-50 to-cyan-100 p-5 rounded-xl border-l-4 border-cyan-500">
            <h4 className="text-cyan-700 font-bold mb-2 flex items-center gap-2">
              <BarChart3 className="w-5 h-5" />
              Update CMAs Weekly
            </h4>
            <p className="text-sm text-slate-700">Market moving fast - keep comps current</p>
          </div>
          <div className="bg-gradient-to-br from-orange-50 to-orange-100 p-5 rounded-xl border-l-4 border-orange-500">
            <h4 className="text-orange-700 font-bold mb-2 flex items-center gap-2">
              <Home className="w-5 h-5" />
              Focus on First-Time Buyers
            </h4>
            <p className="text-sm text-slate-700">High activity in $250-300k range</p>
          </div>
        </div>
      </div>

      {/* Insights Feed */}
      <div className="bg-white rounded-xl p-6 shadow-lg">
        <h3 className="text-xl font-bold text-slate-900 mb-6 flex items-center gap-2">
          <Activity className="w-6 h-6 text-yellow-500" />
          Live Market Insights
        </h3>
        <div className="space-y-4">
          <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-5 border-l-4 border-green-500">
            <div className="flex items-start justify-between mb-3">
              <h4 className="font-bold text-green-700 text-lg">üìà Price Momentum Building</h4>
              <span className="text-xs text-slate-500">2 min ago</span>
            </div>
            <p className="text-slate-700 mb-3">3 consecutive days of price increases in Warner Robins. Consider adjusting listing strategies.</p>
            <div className="flex gap-2">
              <span className="text-xs bg-green-200 text-green-700 px-3 py-1 rounded-full font-medium">Pricing</span>
              <span className="text-xs bg-blue-200 text-blue-700 px-3 py-1 rounded-full font-medium">Strategy</span>
            </div>
          </div>

          <div className="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-5 border-l-4 border-blue-500">
            <div className="flex items-start justify-between mb-3">
              <h4 className="font-bold text-blue-700 text-lg">üéØ First-Time Buyer Activity</h4>
              <span className="text-xs text-slate-500">15 min ago</span>
            </div>
            <p className="text-slate-700 mb-3">Increased search activity from first-time buyers in the $250-300k range.</p>
            <div className="flex gap-2">
              <span className="text-xs bg-purple-200 text-purple-700 px-3 py-1 rounded-full font-medium">Buyers</span>
              <span className="text-xs bg-yellow-200 text-yellow-700 px-3 py-1 rounded-full font-medium">Opportunity</span>
            </div>
          </div>

          <div className="bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl p-5 border-l-4 border-slate-500">
            <div className="flex items-start justify-between mb-3">
              <h4 className="font-bold text-slate-700 text-lg">üè† New Listing Alert</h4>
              <span className="text-xs text-slate-500">30 min ago</span>
            </div>
            <p className="text-slate-700 mb-3">5 new listings entered the market this morning. All priced competitively.</p>
            <div className="flex gap-2">
              <span className="text-xs bg-cyan-200 text-cyan-700 px-3 py-1 rounded-full font-medium">Inventory</span>
              <span className="text-xs bg-green-200 text-green-700 px-3 py-1 rounded-full font-medium">New</span>
            </div>
          </div>
        </div>
      </div>

      {/* Footer */}
      <div className="mt-8 text-center text-slate-500 text-sm">
        <p>¬© 2024 RHMR Pro Dashboard | Real-Time Real Estate Intelligence</p>
        <p className="mt-2">Data Sources: Zillow ‚Ä¢ Realtor.com ‚Ä¢ MLS ‚Ä¢ Public Records</p>
      </div>
    </div>
  );
};

export default RealEstateDashboard;
